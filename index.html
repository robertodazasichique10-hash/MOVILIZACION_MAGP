<!DOCTYPE html>

<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SISTEMA DE MOVILIZACIÓN - MAGP</title>
<script src=""></script>
<style>
body { font-family: Arial, sans-serif; margin: 20px; background: #f4f4f4; }
.container { max-width: 800px; margin: auto; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
h2 { text-align: center; color: #2c3e50; }
.section { border: 1px solid #ddd; padding: 15px; margin-bottom: 20px; border-radius: 5px; }
label { font-weight: bold; display: block; margin-top: 10px; }
input, select, textarea { width: 100%; padding: 8px; margin-top: 5px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; }
.canvas-container { border: 1px solid #000; background: #fff; margin-top: 10px; position: relative; cursor: crosshair; }
canvas { width: 100%; height: 150px; display: block; }
.btn { display: block; width: 100%; padding: 10px; background: #27ae60; color: white; border: none; border-radius: 5px; font-size: 16px; cursor: pointer; margin-top: 10px; }
.btn-clear { background: #e74c3c; margin-top: 5px; padding: 5px; font-size: 12px; }
#qrcode { display: flex; justify-content: center; margin-top: 20px; }
#login, #app { display: none; }
.status { text-align: center; font-weight: bold; color: #2980b9; margin-bottom: 10px; }
</style>
</head>
<body>
<div class="container">
<h2>ORDEN DE MOVILIZACIÓN Y COMBUSTIBLE</h2>
<div id="login" style="display: block;">
<label>Ingrese su número de cédula:</label>
<input type="text" id="u" placeholder="Cédula">
<button class="btn" onclick="login()">INGRESAR</button>
</div>
<div id="app">
<p id="status" class="status"></p>
<div class="section">
<label>Fecha de Emisión:</label>
<input type="date" id="f_actual">
<label>Cédula del Conductor:</label>
<input type="text" id="cedulaCond" readonly>
<label>Destino:</label>
<input type="text" id="destino" placeholder="Ej: Esmeraldas - Quito">
<label>Motivo:</label>
<textarea id="motivo" placeholder="Descripción de la comisión"></textarea>
</div>
<div class="section">
<h3>ORDEN DE COMBUSTIBLE</h3>
<label>Tipo de Combustible:</label>
<select id="tipoComb">
<option value="Extra">Extra</option>
<option value="Súper">Súper</option>
<option value="Diesel">Diesel</option>
</select>
<label>Galones:</label>
<input type="number" id="galones" placeholder="0.00">
</div>
<div class="section">
<h3>FIRMAS ELECTRÓNICAS OBLIGATORIAS</h3>
<label>1. Firma del Jefe Solicitante:</label>
<div class="canvas-container"><canvas id="sig1"></canvas></div>
<button class="btn btn-clear" onclick="clearSig('sig1')">Borrar Firma</button>
<label>2. Firma Responsable Transportes:</label>
<div class="canvas-container"><canvas id="sig2"></canvas></div>
<button class="btn btn-clear" onclick="clearSig('sig2')">Borrar Firma</button>
<label>3. Firma Máxima Autoridad:</label>
<div class="canvas-container"><canvas id="sig3"></canvas></div>
<button class="btn btn-clear" onclick="clearSig('sig3')">Borrar Firma</button>
</div>
<button class="btn" onclick="finalizarOrden()">GENERAR ORDEN Y QR</button>
<div id="qrcode"></div>
</div>
</div>
<script>
let currentUser = "";
function login() {
const u = document.getElementById('u').value.trim();
const autorizados = ["0801671090", "1311423683", "1717178824", "0801587890", "0802872598", "0802440495", "0914087879", "0800899536", "1304230343", "0801666371", "0802320606", "0802159962", "0802259416", "0801461740", "0802860221", "0800626897", "0801822552", "0804371664", "0804497238", "0803463587", "0803290352", "0801587338", "0802547018", "0802881094", "1720782653", "0802236471", "0801104977", "0804393635", "1003613526", "0801686361", "0800673220", "0803138544", "1725888554", "0802577858", "0802772806", "0926011941", "0802311357", "0802588582", "2300505803", "0802275099", "0802774158", "1716820632", "0802605931", "0802507079", "0802328666", "0801861006", "1309695276", "0850584517", "0801890039", "1304194283", "0800858490", "0919043182", "0802138222", "1309587309", "1312187592", "0801252073", "0802772129", "1311542516", "0801611880", "0803150259", "0802132696", "1206243782", "0803805613", "0802679654", "1313572313", "1311660714", "0801883026", "1712295904", "1726634544", "0803129865", "0802521153", "0802130799", "0802834804", "0802836296", "0801534363", "0804569093", "0802077651", "0804374346", "0941574428", "0801712282", "0802018069", "0802503375", "0801758756", "0803235548", "0802944686"];
if (autorizados.includes(u)) {
currentUser = u;
document.getElementById('login').style.display = 'none';
document.getElementById('app').style.display = 'block';
document.getElementById('cedulaCond').value = u;
document.getElementById('status').innerText = "Personal MAGP: " + u;
document.getElementById('f_actual').valueAsDate = new Date();
prepararFirmas();
} else { alert("Cédula no registrada."); }
}
function prepararFirmas() {
['sig1', 'sig2', 'sig3'].forEach(id => {
const canvas = document.getElementById(id);
const ctx = canvas.getContext('2d');
let drawing = false;
function startDraw(e) { drawing = true; draw(e); }
function endDraw() { drawing = false; ctx.beginPath(); }
function draw(e) {
if (!drawing) return;
const rect = canvas.getBoundingClientRect();
const x = (e.clientX || e.touches[0].clientX) - rect.left;
const y = (e.clientY || e.touches[0].clientY) - rect.top;
ctx.lineWidth = 2;
ctx.lineCap = 'round';
ctx.lineTo(x, y);
ctx.stroke();
ctx.beginPath();
ctx.moveTo(x, y);
e.preventDefault();
}
canvas.addEventListener('mousedown', startDraw);
canvas.addEventListener('mousemove', draw);
canvas.addEventListener('mouseup', endDraw);
canvas.addEventListener('touchstart', startDraw);
canvas.addEventListener('touchmove', draw);
canvas.addEventListener('touchend', endDraw);
});
}
function clearSig(id) {
const canvas = document.getElementById(id);
const ctx = canvas.getContext('2d');
ctx.clearRect(0, 0, canvas.width, canvas.height);
}
function finalizarOrden() {
const destino = document.getElementById('destino').value;
const qrc = document.getElementById("qrcode");
qrc.innerHTML = "";
const info = "ORDEN MAGP-" + currentUser + " | DESTINO: " + destino + " | FIRMAS COMPLETAS";
new QRCode(qrc, { text: info, width: 128, height: 128 });
alert("Orden generada con éxito.");
}
</script>
</body>
</html>
